import jsPDF from 'jspdf';
import autoTable from 'jspdf-autotable';

// Logo ALUMCE en base64 (usa el nuevo si cambiaste de imagen)
const logoBase64 = 'data:image/jpeg;base64,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';

export const generarPDF_OC = ({ numeroOC, proveedor, rutProveedor, fecha, realizadoPor, clienteNombre, presupuestoNumero, items, totales, comentario }) => {
  const doc = new jsPDF();

  // Insertar logo (proporción ajustada)
  doc.addImage(logoBase64, 'JPEG', 10, 10, 40, 16);

  // Título a la derecha
  doc.setFont('helvetica', 'bold');
  doc.setFontSize(14);
  doc.text(`ORDEN DE COMPRA N° ${numeroOC}`, 200, 18, { align: 'right' });

  // Información de empresa
  doc.setFont('helvetica', 'normal');
  doc.setFontSize(10);
  doc.text('ALUMCE - Ruta D-43 N°4815, Pan de Azúcar, Coquimbo', 10, 35);
  doc.text('RUT: 76.136.919-9', 10, 40);
  doc.text('Mail: adquisiciones@alumce.cl', 10, 45);

  // Proveedor
  doc.setFontSize(11);
  doc.setFont('helvetica', 'bold');
  doc.text('PROVEEDOR', 10, 60);
  doc.setFont('helvetica', 'normal');
  doc.setFontSize(10);
  doc.text(`Nombre: ${proveedor}`, 10, 65);
  doc.text(`RUT: ${rutProveedor}`, 10, 70);

  // Tabla de ítems
  autoTable(doc, {
    startY: 80,
    head: [['Código', 'Producto', 'Cantidad', 'Precio Unitario', 'Total']],
    body: items.map(i => [
      i.codigo,
      i.producto,
      i.cantidad,
      `$${parseInt(i.precio_unitario).toLocaleString()}`,
      `$${(i.cantidad * i.precio_unitario).toLocaleString()}`
    ]),
    styles: { fontSize: 9 },
  });

  const finalY = doc.previousAutoTable.finalY;

  // Totales a la derecha
  doc.setFontSize(11);
  doc.setFont('helvetica', 'bold');
  doc.text(`TOTAL NETO: $${totales.neto.toLocaleString()}    `, 200, finalY + 10, { align: 'right' });
  doc.text(`IVA 19%: $${totales.iva.toLocaleString()}    `, 200, finalY + 17, { align: 'right' });
  doc.text(`TOTAL: $${totales.total.toLocaleString()}    `, 200, finalY + 24, { align: 'right' });

  // Cliente y presupuesto
  doc.setFontSize(10);
  doc.setFont('helvetica', 'normal');
  doc.text(`Cliente: ${clienteNombre}`, 10, finalY + 35);
  doc.text(`Presupuesto: ${presupuestoNumero}`, 10, finalY + 41);

  // Comentario (si hay)
  if (comentario?.trim()) {
    doc.setFont('helvetica', 'bold');
    doc.text('Comentario:', 10, finalY + 50);
    doc.setFont('helvetica', 'normal');
    doc.text(doc.splitTextToSize(comentario, 180), 10, finalY + 56);
  }

 // Firmas
    doc.setFontSize(10);
    const firmasY = finalY + 80;

    doc.text(`Realizado por: ${realizadoPor}`, 10, firmasY);

    doc.line(150, firmasY - 2, 200, firmasY - 2); // línea superior centrada
    doc.text('    Autorizado', 170, firmasY + 3, { align: 'center' });

  // Guardar PDF con nombre incluyendo proveedor
  const nombreArchivo = `OC_${numeroOC}_${proveedor.replace(/ /g, '_')}.pdf`;
  doc.save(nombreArchivo);
};
